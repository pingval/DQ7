# [PS版DQ7 セーブデータ改竄RTA in 2:49](https://www.youtube.com/watch?v=Z8kzHDMWfuQ)

**詳しくは[こっち](./rta-saveglitch-20190623-00h05m05s.md)。**

- プレイ日時: 2019年06月30日
- 計測区間: 本体の電源投入からTHE ENDの羽ペン消滅まで
- 使用ソフト:
  - RPGツクール3
  - PS版DQ7 アルティメットヒッツ版(いわゆる廉価版)
- 使用本体: PS2(SCPH-90000)
- 使用コントローラ: Sony SCPH-1080
- 改ざん用のセーブデータ作成を計測区間に含める（事前に作成したセーブデータの利用は禁止！）
- アニメティカでの8ブロックセーブ中のメモリーカードの抜き差しは禁止（事前に作成したセーブデータを利用できる怖れがあるため）

----

## [自分の3:16](./rta-saveglitch-20190623-00h03m16s.md)からの変更点など

- お絵かき画面に入る前のカーソル位置がそのままお絵かき画面に持ち越されるので、予めカーソルをRGBバーのツマミの位置に持っていく(「タイトルをかく」の「タ」と「イ」の間)。
- メモリーカードを挿したままDQ7を起動していたのを、起動直後に抜いてエニックスのロゴ表示後に改めて挿すように変更。[DQ7の場合、挿したままPS2を起動すると最大で約1.8sロスするため](https://twitter.com/pingval/status/1021777170773897218)。
- 何度も主人公の名前が表示される通常RTAと違って文字数を気にする必要がないので、DQ7の主人公の名前を「ぁ」から○連打で入力できるため操作ミスの少ない「ああああ」へ変更。
- チェックサムが0(= (156..159, 27)の離れた4マスを塗らなくてよい)であり、かつ塗りやすそうなバイナリを[crchack](https://github.com/resilar/crchack)で調べ、以下の塗り方に変更。
```
Hex:
00 00 00 00 00 00 00 00 00 00 7e 00 00 3f 00 00
d0 07 08 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 07 00 00 24 07
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
AnimeMaker:
  7E: ( 42, 27)
  3F: ( 45, 27)
  D0: ( 48, 27)
  07: ( 49, 27)
  08: ( 50, 27)
  07: ( 75, 27)
  24: ( 78, 27)
  07: ( 79, 27)
```

----

## タイムいろいろ

|区間名|通過|区間|戦闘|備考|
|:---:|:---:|:---:|:---:|:---:|
|電源投入|00:00:00|||
|アニメティカ終了|00:01:58|00:01:58|||
|エンディング終了|00:02:49|00:00:51|||

- 計測地点:
  - アニメティカ終了: アニメティカ起動中にリセットした瞬間

----

## 実際のプレイ

- アニメティカの選択時のSTARTボタンや無圧縮セーブ終了後お絵かき画面に戻るときの×ボタンが認識されない謎のロスが発生したものの、アニメティカ終了で2mを切ったのは初めて。
- DQ7のメモカ抜きは無事成功し、ロードに多少ｇｄったものの想定外の2:50切りとなった。

----

## おわりに

- [3分を切った](https://www.youtube.com/watch?v=mHeh0wc6l7Y)次の目標として[アンキモTAのペカレコ最速記録である2:55](https://peca.nemusg.com/index.php?cmd=read&page=Peercast%20Record%2F%C8%FE%CC%A3%A4%B7%A4%F3%A4%DC%20%B5%E6%B6%CB%A4%CE%A5%E1%A5%CB%A5%E5%A1%BC%BB%B0%CB%DC%BE%A1%C9%E9)を設定していたが、それを切ったのみならず2:50まで切れたのでかなり満足。
- 現状、2:40切りは全く見えない。

### チェックサム0になる塗り方

`0x4180..0x41ff`のうち、以下のアドレスの中身以外は好きに変更して良い(はず)  
```
0x4180: 00 or 01
0x4181..0x4186: 00 00 00 00 00 00
0x4190..0x4193: d0 07 08 00
0x41ae..0x41af: 24 07 ;; ロード後に再開するマップ(デバッグルームのどこでもルーラにおける「THEEND」)
0x41fc..0x41ff: 0x4180..0x41fb のバイナリのチェックサム
```
チェックサムを返すサブルーチンのアドレスは`8008c5a4..8008c608`。アルゴリズムはCRC32/BZIP2。[crchack](https://github.com/resilar/crchack)に渡すオプションは`-w32 -p04c11db7 -iffffffff -xffffffff`。

#### [塗るマスの数 < 9 && 使う色数 < 7](./checksum0.txt)

今回のプレイでは8マス6色パターンのひとつを用いた。  
以下の9マス5色パターンも見た感じよさそう。

```
Hex:
00 00 00 00 00 00 00 00 34 00 00 00 07 00 00 00
d0 07 08 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 24 00 24 24 07
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
AnimeMaker:
  34: ( 40, 27)
  07: ( 44, 27)
  D0: ( 48, 27)
  07: ( 49, 27)
  08: ( 50, 27)
  24: ( 75, 27)
  24: ( 77..78, 27)
  07: ( 79, 27)
```

#### [必須マス以外で使う色は07のみ](./checksum0-07only.txt)

がんばって調べてみたが、塗るマスが多くなってしまうせいか、自分が少し試した限りではあまり速くならなかった。
